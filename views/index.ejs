<!-- server/views/index.ejs -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MyApp</title>
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"
    integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
  <style>
    body {
      margin: 0%;
      font-family: cursive;
    }

    .material-symbols-outlined {
      cursor: pointer;
    }

    .masterContainer {
      display: grid;
      grid-template-columns: minmax(300px, 15%) auto;
      /* Two columns layout, first column takes the remaining space */
      height: 100vh;
      /* Set the height of the grid to the full viewport height */
    }

    .sidebar {
      width: 100%;
      /* Full width of the sidebar */
      min-width: 100px;
      /* Set the minimum width */
      height: 100vh;
      /* Full height of the screen */
      padding: 10px;
      box-sizing: border-box;
      background-color: #f8fffc;
    }

    .mainContainer {
      width: 100%;
      /* Full width of the mainContainer */
      height: 100vh;
      /* Full height of the screen */
      padding: 10px;
      box-sizing: border-box;
      /* background-color: blue; */
    }

    .MainHead {
      width: 100%;
      height: 50px;
      font-family: 'Croissant One', cursive;
      position: relative;
      display: flex;
      align-items: center;
      /* padding: 0px 20px 0px 20px; Adjust padding as needed */
    }

    .databases {
      width: 100%;
      height: 50px;
      font-family: 'Croissant One', cursive;
      position: relative;
      display: flex;
      align-items: center;
      /* padding: 0px 20px 0px 20px; Adjust padding as needed */
    }

    .collections {
      width: 100%;
      height: 50px;
      font-family: 'Croissant One', cursive;
      position: relative;
      display: flex;
      align-items: center;
    }

    .MainHead .left {
      margin-left: auto;
      /* Align the span to the right */
    }

    .databases .left {
      margin-left: auto;
      /* Align the span to the right */
    }

    .collections .left {
      margin-left: auto;
      /* Align the span to the right */
    }
  </style>


</head>

<body>
  <div class="masterContainer">
    <div class="sidebar">
      <div class="MainHead">
        <span class="material-symbols-outlined">
          database
        </span>
        DataBases
        <div class="left">
          <span class="material-symbols-outlined left">
            refresh
          </span>
          <span class="material-symbols-outlined left">
            add
          </span>
        </div>

      </div>
      <div class="allDatabases" id="allDatabases">

        <div class="databases">
          <span class="material-symbols-outlined" onclick="showCollectionInSideBar('1', this)">
              chevron_right
          </span>
          hello
          <div class="left">
              <span class="material-symbols-outlined left">
                  add
              </span>
              <span class="material-symbols-outlined">
                  delete
              </span>
          </div>
      </div>
      <div>
        <div class="collections" id="collectionDiv1">
          
          &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;collection1
          <div class="left">
              <span class="material-symbols-outlined">
                  delete
              </span>
          </div>
      </div>
      <div class="collections" id="collectionDiv1">
          
        &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;collection1
        <div class="left">
            <span class="material-symbols-outlined">
                delete
            </span>
        </div>
    </div>
      </div>

      </div>

    </div>
    <div class="mainContainer">

    </div>
  </div>
  <script>
    function setDatabase() {

    }

    function showCollectionInSideBar(id, selfele) {
      console.log(id)
      let ele = document.getElementById(`collectionDiv${id}`);
      // Make an AJAX request using jQuery
      if (ele.style.display == "") {
        ele.style.display = "none";
        selfele.innerHTML = "chevron_right";
      } else {
        $.ajax({
          url: 'http://localhost:3000/getCollectionByDatabaseSidebarPage',
          type: 'POST',
          data: { dbname: id }, // This will send data in the request body
          success: function (data) {
              console.log(data);
              document.getElementById(`collectionDiv${id}`).innerHTML=data;
              ele.style.display = "";
              selfele.innerHTML = "expand_more";
          },
          error: function (xhr, status, error) {
              console.error('Error:', status, error);
          }
      });

      }



      // ele.style.display = (ele.style.display == "") ? "none" : "";
      //  = (ele.style.display != "") ? "chevron_right" : "expand_more";
    }



    $(document).ready(function () {
      // Attach a click event to the button

      // Make an AJAX request using jQuery
      $.ajax({
        url: 'http://localhost:3000/getAllDatabaseListSidebarPage',  // Replace with your server-side endpoint
        type: 'GET',
        success: function (data) {
          // Handle the successful response
          $('#allDatabases').html(data);
          console.log(data);
        },
        error: function (xhr, status, error) {
          // Handle errors
          console.error('Error:', status, error);
        }
      });

    });
  </script>
</body>

</html>